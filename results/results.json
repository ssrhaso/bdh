{
  "experiment": "BDH vs Transformer: Multi-Hop Reasoning Ablation Study",
  "date": "2026-01-31",
  "configuration": {
    "device": "cuda",
    "precision": "bfloat16",
    "training_iterations": 1500,
    "training_chain_length": 3,
    "test_chain_lengths": [3, 5, 7, 10, 15, 20],
    "seeds": [8, 88, 888, 8888, 88888, 888888, 8888888, 88888888, 888888888, 1888888888],
    "num_seeds": 10
  },
  "model_architecture": {
    "bdh": {
      "total_parameters": 3154176,
      "active_parameters_approx": 63083,
      "sparsity": "~98% inactive",
      "citation": "Pathway Technology (2025)"
    },
    "transformer": {
      "total_parameters": 865569,
      "active_parameters": 865569,
      "sparsity": "0% (dense)",
      "type": "Encoder-only (bidirectional attention)",
      "normalization": "Pre-LayerNorm (Xiong et al., 2020)",
      "positional_encoding": "Learned absolute (Radford et al., 2019)",
      "citation": "Vaswani et al. (2017)"
    }
  },
  "per_seed_results": {
    "seed_8": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 100.0, "10": 100.0, "15": 100.0, "20": 0.0},
      "transformer": {"3": 100.0, "5": 22.7, "7": 20.5, "10": 27.5, "15": 21.1, "20": 12.7}
    },
    "seed_88": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 77.5, "10": 100.0, "15": 85.7, "20": 0.0},
      "transformer": {"3": 100.0, "5": 20.3, "7": 24.0, "10": 15.4, "15": 18.2, "20": 10.9}
    },
    "seed_888": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 100.0, "10": 100.0, "15": 82.6, "20": 0.0},
      "transformer": {"3": 100.0, "5": 16.2, "7": 12.9, "10": 19.9, "15": 17.8, "20": 9.0}
    },
    "seed_8888": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 100.0, "10": 100.0, "15": 88.7, "20": 0.0},
      "transformer": {"3": 100.0, "5": 14.8, "7": 17.4, "10": 12.3, "15": 12.5, "20": 9.2}
    },
    "seed_88888": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 0.0, "10": 48.4, "15": 100.0, "20": 0.0},
      "transformer": {"3": 100.0, "5": 33.8, "7": 33.0, "10": 24.4, "15": 12.1, "20": 9.0}
    },
    "seed_888888": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 100.0, "10": 100.0, "15": 74.2, "20": 0.0},
      "transformer": {"3": 100.0, "5": 33.6, "7": 27.3, "10": 27.5, "15": 21.7, "20": 11.1}
    },
    "seed_8888888": {
      "bdh": {"3": 100.0, "5": 0.0, "7": 0.0, "10": 0.0, "15": 100.0, "20": 0.0},
      "transformer": {"3": 100.0, "5": 15.8, "7": 15.6, "10": 23.2, "15": 21.3, "20": 10.7}
    },
    "seed_88888888": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 100.0, "10": 100.0, "15": 90.2, "20": 0.0},
      "transformer": {"3": 100.0, "5": 30.5, "7": 25.4, "10": 16.4, "15": 12.3, "20": 10.4}
    },
    "seed_888888888": {
      "bdh": {"3": 100.0, "5": 60.5, "7": 0.0, "10": 8.8, "15": 100.0, "20": 0.0},
      "transformer": {"3": 100.0, "5": 29.9, "7": 71.1, "10": 47.9, "15": 15.6, "20": 9.0}
    },
    "seed_1888888888": {
      "bdh": {"3": 100.0, "5": 100.0, "7": 100.0, "10": 100.0, "15": 89.3, "20": 0.0},
      "transformer": {"3": 100.0, "5": 24.4, "7": 34.8, "10": 29.9, "15": 26.8, "20": 9.4}
    }
  },
  "aggregated_results": {
    "bdh": {
      "3": {"mean": 100.0, "std": 0.0, "values": [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]},
      "5": {"mean": 86.05, "std": 31.65, "values": [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 0.0, 100.0, 60.5, 100.0]},
      "7": {"mean": 67.75, "std": 44.08, "values": [100.0, 77.5, 100.0, 100.0, 0.0, 100.0, 0.0, 100.0, 0.0, 100.0]},
      "10": {"mean": 75.72, "std": 38.59, "values": [100.0, 100.0, 100.0, 100.0, 48.4, 100.0, 0.0, 100.0, 8.8, 100.0]},
      "15": {"mean": 91.07, "std": 8.86, "values": [100.0, 85.7, 82.6, 88.7, 100.0, 74.2, 100.0, 90.2, 100.0, 89.3]},
      "20": {"mean": 0.0, "std": 0.0, "values": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}
    },
    "transformer": {
      "3": {"mean": 100.0, "std": 0.0, "values": [100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]},
      "5": {"mean": 24.2, "std": 7.25, "values": [22.7, 20.3, 16.2, 14.8, 33.8, 33.6, 15.8, 30.5, 29.9, 24.4]},
      "7": {"mean": 28.2, "std": 16.26, "values": [20.5, 24.0, 12.9, 17.4, 33.0, 27.3, 15.6, 25.4, 71.1, 34.8]},
      "10": {"mean": 24.44, "std": 9.82, "values": [27.5, 15.4, 19.9, 12.3, 24.4, 27.5, 23.2, 16.4, 47.9, 29.9]},
      "15": {"mean": 17.94, "std": 4.76, "values": [21.1, 18.2, 17.8, 12.5, 12.1, 21.7, 21.3, 12.3, 15.6, 26.8]},
      "20": {"mean": 10.14, "std": 1.18, "values": [12.7, 10.9, 9.0, 9.2, 9.0, 11.1, 10.7, 10.4, 9.0, 9.4]}
    }
  },
  "summary": {
    "in_distribution": {
      "chain_length": 3,
      "bdh_accuracy": 100.0,
      "transformer_accuracy": 100.0,
      "difference": 0.0,
      "note": "Both models achieve perfect in-distribution accuracy"
    },
    "out_of_distribution": {
      "chain_lengths": [5, 7, 10, 15, 20],
      "bdh_mean_accuracy": 64.12,
      "transformer_mean_accuracy": 20.98,
      "bdh_advantage": 43.14,
      "note": "Excluding 20-hop where both fail"
    },
    "out_of_distribution_excluding_20hop": {
      "chain_lengths": [5, 7, 10, 15],
      "bdh_mean_accuracy": 80.15,
      "transformer_mean_accuracy": 23.70,
      "bdh_advantage": 56.45
    }
  },
  "statistical_notes": {
    "high_variance_seeds": [
      "seed_88888: BDH shows 0% at 7-hop but 100% at 15-hop",
      "seed_8888888: BDH shows 0% at 5,7,10-hop but 100% at 15-hop",
      "seed_888888888: Transformer unusually high at 7-hop (71.1%)"
    ],
    "interpretation": "High variance in BDH suggests sensitivity to random initialization for certain chain lengths, but consistently outperforms Transformer on average"
  },
  "citations": {
    "task_design": [
      "Zhang et al. (2021) - Pointer Value Retrieval",
      "Lake & Baroni (2018) - Compositional Generalization",
      "Hupkes et al. (2020) - Compositionality Decomposed",
      "Anil et al. (2022) - Length Generalization in LLMs",
      "Press et al. (2022) - ALiBi"
    ],
    "transformer_baseline": [
      "Vaswani et al. (2017) - Attention Is All You Need",
      "Xiong et al. (2020) - Pre-LayerNorm",
      "Radford et al. (2019) - GPT-2 positional embeddings"
    ],
    "bdh_architecture": [
      "Pathway Technology (2025) - Baby Dragon Hatchling"
    ]
  }
}
